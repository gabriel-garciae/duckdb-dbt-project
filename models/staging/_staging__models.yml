version: 2

models:
  - name: stg_vehicles
    description: "Staging model para a tabela raw_vehicles. Contém informações básicas dos veículos da frota."
    columns:
      - name: vehicle_id
        description: "Identificador único do veículo"
        tests:
          - unique
          - not_null
      - name: plate
        description: "Placa do veículo"
        tests:
          - unique
          - not_null
      - name: type
        description: "Tipo do veículo (Truck, Van, Car)"
        tests:
          - not_null
          - accepted_values:
              values: ['Truck', 'Van', 'Car']
      - name: status
        description: "Status do veículo (Active, Sold, Totaled)"
        tests:
          - not_null
          - accepted_values:
              values: ['Active', 'Sold', 'Totaled']

  - name: stg_maintenance_costs
    description: "Staging model para a tabela raw_maintenance_costs. Contém registros de custos de manutenção (preventiva e corretiva)."
    columns:
      - name: maintenance_id
        description: "Identificador único da manutenção"
        tests:
          - unique
          - not_null
      - name: vehicle_id
        description: "Identificador do veículo"
        tests:
          - not_null
          - relationships:
              to: ref('stg_vehicles')
              field: vehicle_id
      - name: cost_type
        description: "Tipo de custo (Preventiva ou Corretiva)"
        tests:
          - not_null
          - accepted_values:
              values: ['Preventiva', 'Corretiva']
      - name: amount
        description: "Valor do serviço em reais"
        tests:
          - not_null
      - name: entry_date
        description: "Data de entrada na oficina/abastecimento"
        tests:
          - not_null
      - name: return_date
        description: "Data de saída da oficina (pode ser NULL se ainda está em manutenção)"

  - name: stg_telemetry
    description: "Staging model para a tabela raw_telemetry. Dados de telemetria GPS recebidos a cada 30 segundos (alta frequência/volume)."
    columns:
      - name: event_id
        description: "Identificador único do evento de telemetria"
        tests:
          - unique
          - not_null
      - name: vehicle_id
        description: "Identificador do veículo"
        tests:
          - not_null
          - relationships:
              to: ref('stg_vehicles')
              field: vehicle_id
      - name: timestamp
        description: "Timestamp do evento"
        tests:
          - not_null
      - name: odometer_value
        description: "Valor acumulado do odômetro em KM"
        tests:
          - not_null
      - name: engine_status
        description: "Status do motor (true = ligado, false = desligado)"
        tests:
          - not_null
      - name: speed
        description: "Velocidade atual em km/h"
        tests:
          - not_null

